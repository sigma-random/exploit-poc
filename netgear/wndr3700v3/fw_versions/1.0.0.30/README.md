###DESCRIPTION####
    Author: Zachary Cutlip
            uid000 at gmail dot com
            Twitter:@zcutlip
    Target: Netgear WNDR3700v3
    Firmware: 1.0.0.30

This exploit targets a SQL injection and a buffer overflow in the MiniDLNA process running on the WNDR3700v3 (and many other netgear routers.)

Using the SQL Injection, this exploit can do two things:

1. With a specially crafted SOAP request, stage a malicious database record in the album art table that points to arbitrary files on the file system, and then retrieve those files using an unauthenticated HTTP request.
2. With a specially crafted SOAP request, stage a buffer overflow string in the database and subsequently trigger the buffer overflow with a with a Browse SOAP request.

####USAGE####

You will require the latest Bowcaster from:
https://github.com/zcutlip/Bowcaster.git

If you specify the `-t <target>`, `-e <path>`, and `-F <local file>` options, you can extract a file from the target and save it locally.

If you specify the if you specify the `-t <target>` and `-c <connect-back ip>` options, the script will exploit the buffer overflow, giving the target a connect-back shell.

The usage of the exploit script is:

    Usage: ./exploit_dlna.py [OPTIONS]
    
    Option summary:
    -t, --target=IP_ADDRESS          Remote target to exploit.
                                    This option is mutually exclusive with -f.
    -p,--port=PORT                   Port to connect to.
                                    This option requires -t.
                                    This option is mutually exclusive with -f.
    -c,--connectback_ip=IP_ADDRESS   Connect-back IP address.
                                    This option is mutually exclusive with -e.
    -e,--extract=FILE                Full path to a file on the target to extract.
                                    This option requires -F.
                                    This option is mutually exclusive with -c and -f
                                    because no buffer overflow string will be generated.
    -F,--file=FILE                   Local file to save extracted file to.
                                    This option requires -e.
                                    This option is mutually exclusive with -c and -f.
    -f,--find_offset=FIND_STRING     String whose offset in the overflow buffer
                                    to find and report.
                                    This option requires -c.
                                    This option is mutually exclusive with -e.
                                    This option is mutually exclusive with -t